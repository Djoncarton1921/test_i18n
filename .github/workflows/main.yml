name: Translate locales js

on:
  push:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Read target languages from file
        id: read-languages
        run: |
          echo "::set-output name=languages::$(cat locales-list.txt)"
      - name: Translate with Microsoft Translator
        id: translate
        run: |
          for lang in ${{ steps.read-languages.outputs.languages }}; do
            mkdir -p src/i18n/$lang
            for file in src/i18n/ua/*.js; do
              filename=$(basename "$file")
              file_content=$(cat "$file")
              echo $file_content
              translated_text=curl -X POST "https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&from=en&to=de" -H "Ocp-Apim-Subscription-Key: <client-secret>" -H "Content-Type: application/json; charset=UTF-8" -d "[{'Text':'The word <mstrans:dictionary translation=\"wordomatic\">wordomatic</mstrans:dictionary> is a dictionary entry.'}]" \
                | jq -r '.[0].translations[0].text')
              echo "$translated_text" > "src/i18n/$lang/$filename"
            done
          done
